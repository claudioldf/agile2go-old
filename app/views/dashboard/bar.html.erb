<br />
<div id="chart" style="width:100%; height:400px;"></div>

<script>        
	$(function(){ 
        $('#content').removeClass('content')
    	$('#chart').highcharts({
        	chart: {
            	type: 'bar'
        	},
        	title: {
            	text: 'Dashboard'
        	},
        	xAxis: {
            	categories: [ <% Project.all.map do |p| %> '<%= p.name %>', <% end %> ]
        	},
        	yAxis: {
            	title: {
	                text: 'Qtd'
            	}
        	},
            plotOptions: {
                series: {
                    stacking: 'normal'
                }
            },
        	series: [                         
            <% Task.select("distinct status").each do |t| %>
            {
            	name: '<%= t.status %>',                
            	data: [ 10,2,3 ]
        	},            
            <% end %>]
    	});
	});
</script>

<!-- 
Task.select('tasks.id,tasks.status as status, count(tasks.id) as qtd').joins(':sprints => projects').group('tasks.status, tasks.id')


Project.select('status, count(tasks.id) as qtd').joins("join sprints s on s.project_id = p.id join tasks t on t.sprint_id = s.id").group('status')


Task.find_by_sql("select distinct t.status, count(t.id) from tasks t join sprints s on s.id = t.sprint_id join projects p on p.id = s.project_id where 1=1 group by s.id, t.status UNION select distinct st.status, 0 qtd from tasks t join sprints s on s.id = t.sprint_id join projects p on p.id = s.project_id, (select 'TODO' status union select 'ONGOING' status union select 'DONE' status) st where 1=1 group by s.id, st.status")

Project.find_by_sql("select t.status, count(t.id)
                                from projects p
                                join sprints s on s.project_id = p.id
                                join tasks t on s.id = t.sprint_id
                                group by t.status")

-->
